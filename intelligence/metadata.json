{
  "intelligence_system": {
    "version": "1.1.0",
    "created": "2025-11-25",
    "last_updated": "2025-11-29",
    "author": "BQXML Chief Engineer",
    "purpose": "Comprehensive knowledge base for BQX ML V3 project",
    "files": [
      "context.json - Project context and infrastructure",
      "semantics.json - Terminology and concept definitions",
      "ontology.json - Entity relationships and data model",
      "protocols.json - Development and operational procedures",
      "constraints.json - Architectural and business constraints",
      "workflows.json - End-to-end process workflows",
      "mandates.json - Critical user mandates and requirements",
      "metadata.json - Intelligence system metadata (this file)"
    ]
  },
  "project_metadata": {
    "name": "BQX ML V3",
    "full_name": "BQX Machine Learning System Version 3.0",
    "description": "28 independent machine learning models for forex momentum prediction",
    "type": "Machine Learning / Financial Technology",
    "domain": "Forex Trading / Quantitative Finance",
    "methodology": "Supervised Learning / Time Series Prediction",
    "technology_stack": {
      "languages": ["Python 3.10+", "SQL", "Bash"],
      "frameworks": ["scikit-learn", "XGBoost", "LightGBM", "TensorFlow", "PyTorch"],
      "infrastructure": ["Google Cloud Platform", "BigQuery", "Vertex AI", "Cloud Run"],
      "tools": ["AirTable", "GitHub", "Claude Code", "Docker"],
      "monitoring": ["Grafana", "Prometheus", "Datadog"]
    }
  },
  "repository_metadata": {
    "platform": "GitHub",
    "owner": "Schmidtlappin",
    "repository": "bqx_ml_v3",
    "url": "https://github.com/Schmidtlappin/bqx_ml_v3",
    "visibility": "Private",
    "default_branch": "main",
    "created": "2024-11-24",
    "latest_commit": "8091732",
    "total_commits": 7,
    "contributors": 1,
    "lines_of_code": 23500,
    "files": 76,
    "directories": {
      "docs": "35 documentation files",
      "scripts": "33 Python/Bash scripts",
      "src": "Source code (8 subdirectories)",
      "tests": "Test suite (3 subdirectories)",
      "intelligence": "7 intelligence JSON files",
      "credentials": "Credentials (gitignored)",
      ".secrets": "Secrets (gitignored)"
    }
  },
  "planning_metadata": {
    "project_management": "AirTable",
    "project_id": "MP03",
    "base_id": "appR3PPnrNkVo48mO",
    "hierarchy": {
      "plan": 1,
      "phases": 11,
      "stages": 70
    },
    "status": {
      "completion": "100%",
      "stages_90plus": "100%",
      "stages_95plus": "74.3%",
      "gap_coverage": "100%"
    },
    "current_phase": "Feature Implementation COMPLETE - Ready for Model Training",
    "next_milestone": "Model training with 196 models (28 pairs × 7 horizons)",
    "phase_status": {
      "Phase 0": "COMPLETE - Infrastructure setup",
      "Phase 1": "COMPLETE - Data ingestion and validation",
      "Phase 1B": "COMPLETE - BQX feature tables",
      "Phase 2": "COMPLETE - Feature engineering",
      "Phase 2.5A": "COMPLETE - Gap closure",
      "Phase 2.5B": "COMPLETE - Target-based correlation (109,760 correlations)",
      "Phase 2.5B-R": "COMPLETE - corr_bqx_ remediation (224 tables)",
      "cov_* Remediation": "COMPLETE - 2,352 covariance tables",
      "Additional Features": "COMPLETE - 280 oscillation prediction tables",
      "Phase 3": "READY - Model training"
    },
    "additional_features": {
      "status": "COMPLETE",
      "completed_at": "2025-11-29T17:20:00Z",
      "total_tables": 280,
      "phases": {
        "phase1_rev_der": {"tables": 112, "types": ["rev_", "rev_bqx_", "der_", "der_bqx_"]},
        "phase2_ext_cyc": {"tables": 56, "types": ["ext_bqx_", "cyc_bqx_"]},
        "phase3_div_mrt": {"tables": 84, "types": ["div_", "div_bqx_", "mrt_bqx_"]},
        "phase4_tmp": {"tables": 28, "types": ["tmp_"]}
      },
      "architecture": "INTERVAL-CENTRIC (except tmp_ which is TIME-CENTRIC)"
    }
  },
  "data_metadata": {
    "source": "Forex market data providers",
    "frequency": "1-minute OHLCV bars",
    "currency_pairs": 28,
    "historical_period": "7+ years",
    "data_warehouse": "BigQuery",
    "datasets": {
      "bqx_bq_uscen1": "Base data tables (2,463)",
      "bqx_ml_v3_features": "Feature tables (4,061)",
      "bqx_ml_v3_analytics": "Target tables (28)",
      "bqx_ml_v3_models": "Model artifacts (16)",
      "bqx_ml_v3_predictions": "Prediction outputs (pending)"
    },
    "tables": {
      "current": 4061,
      "required": 4061,
      "coverage": "100%",
      "remediation_pending": 0,
      "types": ["primary", "correlation", "covariance", "oscillation"],
      "inventory": {
        "corr_*": 448,
        "cov_*": 2352,
        "additional_features": 280,
        "primary": 224,
        "other": 757
      }
    },
    "feature_matrix": {
      "feature_types": 18,
      "centrics": 6,
      "variants": 2,
      "theoretical_cells": 96,
      "feature_types_list": ["reg_", "agg_", "lag_", "regime_", "align_", "corr_", "mom_", "vol_", "rev_", "rev_bqx_", "der_", "der_bqx_", "ext_bqx_", "cyc_bqx_", "div_", "div_bqx_", "mrt_bqx_", "tmp_"],
      "centrics_list": ["PRIMARY", "VARIANT", "COVARIANT", "TRIANGULATION", "SECONDARY", "TERTIARY"],
      "variants_list": ["IDX (price-based)", "BQX (momentum-based)"]
    },
    "polynomial_regression": {
      "status": "SPECIFICATION_COMPLETE",
      "formula": {
        "equation": "y = ax² + bx + c (quadratic polynomial)",
        "x_array": "np.arange(W) = [0, 1, 2, ..., W-1]",
        "y_array": "values[-W:] (last W source values)",
        "fit_method": "np.polyfit(x, y, 2) → [a, b, c]"
      },
      "coefficients": {
        "quad_term": "a - curvature/acceleration coefficient",
        "lin_term": "b - slope/velocity coefficient",
        "const_term": "c - intercept"
      },
      "derived_features": {
        "reg_quad_norm_{W}": "quad * (W-1)² / mean(y)",
        "reg_lin_norm_{W}": "lin * (W-1) / mean(y)",
        "reg_r2_{W}": "1 - SS_res / SS_tot",
        "reg_rmse_{W}": "sqrt(mean(residuals²))",
        "reg_resid_std_{W}": "std(y - y_hat)",
        "reg_resid_last_{W}": "residuals[-1]",
        "reg_acceleration_{W}": "2 * quad_term",
        "reg_trend_str_{W}": "lin_term / resid_std",
        "reg_forecast_5_{W}": "polyval(x+5) - polyval(x)"
      },
      "windows": [45, 90, 180, 360, 720, 1440, 2880],
      "specification_files": {
        "primary": "/features/POLYNOMIAL_REG_FEATURES.md",
        "covariance": "/features/COV_REG_FEATURES.md",
        "variance": "/features/VAR_REG_FEATURES.md",
        "csi": "/features/CSI_REG_FEATURES.md",
        "triangular": "/features/TRI_REG_FEATURES.md",
        "market": "/features/MKT_REG_FEATURES.md"
      },
      "gap_analysis": "/mandate/POLYNOMIAL_REGRESSION_FEATURE_GAP_ANALYSIS.md"
    },
    "variant_architecture": {
      "IDX": {
        "source": "Close price (OHLCV data)",
        "table_pattern": "reg_{pair}",
        "interpretation": "Price-derived polynomial trends",
        "use_case": "Detect price trend exhaustion"
      },
      "BQX": {
        "source": "BQX oscillator value",
        "table_pattern": "reg_bqx_{pair}",
        "interpretation": "Momentum-derived polynomial trends",
        "use_case": "Detect momentum exhaustion/reversal"
      }
    },
    "correlation_evaluation": {
      "methodology": "Extreme Oscillation Correlation Analysis",
      "extreme_selection": "|BQX_45| > 2σ (5000 points)",
      "window_extraction": "301 intervals per extreme",
      "correlation_type": "Pooled Pearson correlation",
      "targets": {
        "count": 49,
        "formula": "7 windows × 7 horizons",
        "windows": [45, 90, 180, 360, 720, 1440, 2880],
        "horizons": [15, 30, 45, 60, 75, 90, 105]
      },
      "current_analysis": {
        "features": 817,
        "top_correlation": 0.9982,
        "top_feature": "reg_slope_2880"
      },
      "expanded_analysis": {
        "features": 1069,
        "new_polynomial_features": 252,
        "strategy_doc": "/mandate/CORRELATION_STRATEGY_EXPANSION.md"
      }
    },
    "features": {
      "price_features": "~100 per pair",
      "bqx_features": "~180 per pair (includes lags)",
      "technical_indicators": "~50 per pair",
      "regime_features": "~20 per pair",
      "oscillation_features": "~70 per pair (rev, der, ext, cyc, div, mrt, tmp)",
      "total_per_pair": "~420 features"
    }
  },
  "model_metadata": {
    "architecture": "Independent Model per Currency Pair per Horizon",
    "total_models": 196,
    "breakdown": "28 pairs × 7 horizons",
    "prediction_horizons": [15, 30, 45, 60, 75, 90, 105],
    "horizon_note": "Intervals forward (row-based, NOT time-based)",
    "algorithms": [
      {
        "name": "RandomForest",
        "type": "Ensemble",
        "count": 28
      },
      {
        "name": "XGBoost",
        "type": "Gradient Boosting",
        "count": 28
      },
      {
        "name": "LightGBM",
        "type": "Gradient Boosting",
        "count": 28
      },
      {
        "name": "LSTM",
        "type": "Deep Learning",
        "count": 28
      },
      {
        "name": "GRU",
        "type": "Deep Learning",
        "count": 28
      }
    ],
    "ensemble": "Weighted average based on recent performance",
    "target": "Future BQX momentum values via LEAD(bqx_*, H)",
    "bqx_components": ["bqx_45", "bqx_90", "bqx_180", "bqx_360", "bqx_720", "bqx_1440", "bqx_2880"],
    "training_frequency": "Weekly full retrain + daily fine-tuning",
    "validation": "Time-series cross-validation (5 folds)"
  },
  "api_metadata": {
    "rest_api": {
      "framework": "FastAPI",
      "deployment": "Cloud Run",
      "authentication": "API Key + OAuth2",
      "rate_limiting": "1000 requests/min per client",
      "endpoints": [
        "GET /predict/{pair}",
        "POST /predict/batch",
        "GET /health",
        "GET /models/{pair}/info"
      ]
    },
    "websocket_api": {
      "protocol": "WebSocket",
      "purpose": "Real-time streaming predictions",
      "frequency": "Every 1-minute bar close",
      "authentication": "Token-based"
    }
  },
  "security_metadata": {
    "secrets_management": {
      "github_secrets": 4,
      "gcp_secret_manager": true,
      "rotation_policy": "Every 90 days"
    },
    "authentication": {
      "gcp": "Service account (codespace-bqx-ml@bqx-ml.iam.gserviceaccount.com)",
      "github": "Personal access token (Schmidtlappin)",
      "api": "API keys + OAuth2"
    },
    "compliance": {
      "standards": ["GDPR", "SOC2", "ISO27001"],
      "encryption_at_rest": "AES-256",
      "encryption_in_transit": "TLS 1.3",
      "audit_logging": "Enabled for all operations"
    }
  },
  "documentation_metadata": {
    "types": {
      "architecture": "System design and component interaction",
      "api": "OpenAPI specifications for REST and WebSocket",
      "user": "Usage guides and tutorials",
      "developer": "Development setup and contribution guidelines",
      "operational": "Deployment, monitoring, and maintenance"
    },
    "formats": ["Markdown", "JSON", "YAML", "OpenAPI"],
    "location": "/docs directory",
    "total_files": 35,
    "total_lines": "~15,500 lines"
  },
  "testing_metadata": {
    "framework": "pytest",
    "coverage_target": "80%",
    "test_types": {
      "unit": "Individual function/class testing",
      "integration": "Component interaction testing",
      "validation": "End-to-end pipeline validation"
    },
    "ci_cd": "GitHub Actions",
    "test_execution": "On every commit and PR"
  },
  "version_history": {
    "v3.0.0": {
      "date": "2025-11-25",
      "status": "Development",
      "features": [
        "28 independent models",
        "BQX paradigm shift (features + targets)",
        "Interval-centric architecture",
        "Complete AirTable integration",
        "100% project plan coverage"
      ]
    },
    "v2.0.0": {
      "date": "2024",
      "status": "Deprecated",
      "notes": "Migrated from bqx-db monolithic approach"
    }
  },
  "references": {
    "key_documents": [
      "/docs/PROJECT_PLAN_100_PERCENT_COMPLETE.md",
      "/docs/WORKSPACE_AUDIT_AND_GAP_ANALYSIS.md",
      "/docs/BQX_ML_V3_PIPELINE.md",
      "/docs/BQX_ML_FEATURE_MATRIX.md",
      "/docs/PARADIGM_SHIFT_UPDATE_20241124.md",
      "/docs/PHASE_25B_REDO_TARGET_CORRELATION.md",
      "/docs/SESSION_STATUS_REPORT.md",
      "/docs/CLOUD_RUN_BOX_BACKUP.md",
      "/docs/EXTREME_CORRELATION_ANALYSIS_RESULTS.md",
      "/mandate/FEATURE_TABLE_DIRECTORY.md",
      "/mandate/POLYNOMIAL_REGRESSION_FEATURE_GAP_ANALYSIS.md",
      "/mandate/CORRELATION_STRATEGY_EXPANSION.md"
    ],
    "feature_specifications": [
      "/features/POLYNOMIAL_REG_FEATURES.md",
      "/features/COV_REG_FEATURES.md",
      "/features/VAR_REG_FEATURES.md",
      "/features/CSI_REG_FEATURES.md",
      "/features/TRI_REG_FEATURES.md",
      "/features/MKT_REG_FEATURES.md",
      "/features/README.md"
    ],
    "scripts": [
      "/scripts/gap_remediation_stages.py",
      "/scripts/airtable_stage_loader_optimized.py",
      "/scripts/setup_github_secrets.sh",
      "/scripts/create_intelligence_files.py",
      "/scripts/phase25b_redo/01_generate_targets_eurusd.py"
    ],
    "communications": [
      "/.claude/sandbox/communications/outboxes/CE/20251129_0130_CE-to-BA_PHASE25B_FULLSCALE_APPROVED.md",
      "/.claude/sandbox/communications/outboxes/CE/20251129_0145_CE-to-BA_REMEDIATION_CORR_BQX.md"
    ],
    "external_resources": [
      "https://github.com/Schmidtlappin/bqx_ml_v3",
      "AirTable Base: appR3PPnrNkVo48mO"
    ]
  }
}
