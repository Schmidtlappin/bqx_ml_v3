{
  "project": {
    "name": "BQX ML V3",
    "version": "3.0.0",
    "description": "28 independent machine learning models for forex momentum prediction using BQX paradigm",
    "repository": "https://github.com/Schmidtlappin/bqx_ml_v3",
    "owner": "Schmidtlappin",
    "created": "2024-11-24",
    "last_updated": "2025-11-29"
  },
  "paradigm": {
    "name": "BQX Momentum Prediction",
    "description": "BQX values serve as BOTH features AND targets for autoregressive prediction",
    "paradigm_shift_date": "2024-11-24",
    "core_principle": "Historical BQX values contain momentum signals that predict future BQX"
  },
  "architecture": {
    "type": "Independent Model Architecture",
    "model_count": 28,
    "model_scope": "One model per currency pair",
    "isolation": "Complete - no cross-pair contamination",
    "computation": "Interval-centric using ROWS BETWEEN only"
  },
  "infrastructure": {
    "cloud": {
      "provider": "Google Cloud Platform",
      "project_id": "bqx-ml",
      "compute_instance": "bqx-ml-master",
      "zone": "us-east1-b",
      "ip": "34.148.152.67"
    },
    "data": {
      "warehouse": "BigQuery",
      "location": "us-central1",
      "migration_date": "2025-11-28",
      "tables": 1983,
      "mandate_target": 3192,
      "datasets": {
        "bqx_bq_uscen1": "Raw m1 OHLCV data (2,463 tables)",
        "bqx_ml_v3_features": "Engineered features (1,983 tables)",
        "bqx_ml_v3_models": "Trained models (16 models)",
        "bqx_ml_v3_predictions": "Model predictions (0 tables - pending)",
        "bqx_ml_v3_analytics": "Target tables (28 tables)",
        "bqx_ml_v3_staging": "Temporary processing (0 tables)"
      },
      "feature_matrix": {
        "primary": {"current": 504, "required": 392, "coverage": "128.6%", "status": "COMPLETE"},
        "correlation": {"current": 448, "required": 448, "coverage": "100%", "status": "COMPLETE"},
        "covariance": {"current": 554, "required": 2352, "coverage": "23.6%", "status": "REMEDIATION_AUTHORIZED"},
        "total": {"current": 1506, "required": 3192, "coverage": "47.2%"}
      },
      "remediation": {
        "tables_to_create": 1798,
        "estimated_time": "8 hours",
        "directive": "OPTION_A_FULL_COVERAGE",
        "status": "AUTHORIZED"
      }
    },
    "project_management": {
      "tool": "AirTable",
      "project_id": "MP03",
      "base_id": "appR3PPnrNkVo48mO",
      "phases": 11,
      "stages": 70,
      "completion": "29%"
    },
    "version_control": {
      "platform": "GitHub",
      "repository": "Schmidtlappin/bqx_ml_v3",
      "branch": "main",
      "secrets": 4
    },
    "backup": {
      "purpose": "Disaster recovery and business continuity",
      "mandate_reference": "/intelligence/backup_mandate.json",
      "working_backup": {
        "provider": "Google Drive",
        "remote": "gdrive:bqx_ml_v3",
        "tool": "rclone",
        "script": "scripts/sync-bqx-project.sh",
        "role": "Working backup - FILES ONLY",
        "limitations": "Storage quota limits, part of GCP infrastructure",
        "disaster_recovery": false,
        "status": "ACTIVE"
      },
      "disaster_recovery": {
        "provider": "Box.com",
        "folder_id": "353414610676",
        "folder_name": "bqx-ml-v3",
        "auth_method": "JWT",
        "tool": "Box SDK (box_sdk_gen)",
        "scripts": {
          "files": "scripts/sync-box-backup.py",
          "bigquery": "scripts/export-bq-to-box.py"
        },
        "role": "TRUE disaster recovery - FILES AND BigQuery tables",
        "advantages": "Unlimited storage, independent from GCP",
        "disaster_recovery": true,
        "status": "ACTIVE",
        "configured_date": "2025-11-28"
      },
      "cloud_run_automation": {
        "service_name": "bq-to-box-sync",
        "service_url": "https://bq-to-box-sync-499681702492.us-central1.run.app",
        "container_image": "gcr.io/bqx-ml/bq-to-box-sync:latest",
        "region": "us-central1",
        "service_account": "bq-to-box-sync@bqx-ml.iam.gserviceaccount.com",
        "memory": "2Gi",
        "timeout": "3600s",
        "status": "DEPLOYED",
        "deployed_date": "2025-11-29",
        "scheduled_jobs": {
          "bq-to-box-models": "Daily 2 AM UTC (bqx_ml_v3_models)",
          "bq-to-box-features": "Weekly Sunday 3 AM UTC (bqx_ml_v3_features)",
          "bq-to-box-predictions": "Weekly Monday 4 AM UTC (bqx_ml_v3_predictions)",
          "bq-to-box-analytics": "Monthly 1st 5 AM UTC (bqx_ml_v3_analytics)"
        },
        "cost_monthly": "$0.40-3.24",
        "documentation": "/docs/CLOUD_RUN_BOX_BACKUP.md"
      },
      "sync_protocol": {
        "on_user_request": "Sync files to BOTH GDrive AND Box.com",
        "automated_bigquery": "Cloud Run exports BQ tables to Box.com on schedule (ACTIVE)",
        "bigquery_backup": "Export BQ tables to Box.com ONLY (too large for GDrive)"
      },
      "execution_model": {
        "file_sync": "Fast (minutes) - non-blocking",
        "bigquery_backup_manual": "Background process (4-8 hours) - non-blocking",
        "bigquery_backup_automated": "Cloud Run scheduled exports - fully automated"
      },
      "key_rationale": "GDrive is part of GCP - if GCP fails, GDrive may be inaccessible. Box.com is completely independent and can store TB-scale BQ exports."
    }
  },
  "currency_pairs": [
    "EURUSD", "GBPUSD", "USDJPY", "USDCHF", "AUDUSD", "USDCAD", "NZDUSD",
    "EURGBP", "EURJPY", "EURCHF", "EURAUD", "EURCAD", "EURNZD",
    "GBPJPY", "GBPCHF", "GBPAUD", "GBPCAD", "GBPNZD",
    "AUDJPY", "AUDCHF", "AUDCAD", "AUDNZD",
    "NZDJPY", "NZDCHF", "NZDCAD",
    "CADJPY", "CADCHF",
    "CHFJPY"
  ],
  "team": {
    "role": "BQXML Chief Engineer",
    "environment": "bqx-ml-master GCP instance",
    "primary_tools": ["Python", "BigQuery", "Vertex AI", "AirTable", "Claude Code"]
  },
  "current_phase": {
    "phase": "Phase 1B",
    "name": "BQX Dual Architecture Completion",
    "status": "Complete",
    "completion_date": "2025-11-28",
    "next_milestone": "Phase 2: Additional Feature Types or Model Training"
  },
  "polynomial_regression": {
    "status": "CRITICAL_GAP_IDENTIFIED",
    "gap_analysis": "/mandate/POLYNOMIAL_REGRESSION_FEATURE_GAP_ANALYSIS.md",
    "specification": "/features/POLYNOMIAL_REG_FEATURES.md",
    "formula": {
      "equation": "y = β₂x² + β₁x + β₀",
      "x_definition": "np.arange(W) = [0, 1, 2, ..., W-1]",
      "y_definition": "values[-W:] = last W values (close price for IDX, BQX for BQX)",
      "fit_method": "np.polyfit(x, y, 2) → [β₂, β₁, β₀]"
    },
    "user_mandate_v21": {
      "source": "AirTable MP02.P16.S01",
      "description": "Endpoint Evaluation at x = W (NOT raw coefficients)",
      "quad_term": "β₂ × W² - scaled quadratic at endpoint",
      "lin_term": "β₁ × W - scaled linear at endpoint",
      "const_term": "β₀ - constant term (unchanged)",
      "residual": "rate - (quad_term + lin_term + const_term)",
      "rate": "y[-1] (current value, last in window)"
    },
    "windows": [45, 90, 180, 360, 720, 1440, 2880],
    "new_columns_per_window": 19,
    "total_new_columns": 133,
    "tables_to_rebuild": 492,
    "tables_breakdown": {
      "reg_*": 28,
      "reg_bqx_*": 28,
      "cov_reg_*": 168,
      "cov_reg_bqx_*": 168,
      "var_reg_*": 28,
      "csi_reg_*": 32,
      "tri_reg_*": 36,
      "mkt_reg*": 4
    },
    "variants": {
      "IDX": "Price-derived (close price polynomial fit)",
      "BQX": "Momentum-derived (BQX oscillator polynomial fit)"
    },
    "ba_directive": "/.claude/sandbox/communications/outboxes/CE/20251129_1930_CE-to-BA_POLYNOMIAL_REGRESSION_IMPLEMENTATION.md"
  },
  "correlation_analysis": {
    "current_features": 817,
    "expanded_features": 1069,
    "targets": 49,
    "target_formula": "7 windows × 7 horizons",
    "methodology": "Pooled Pearson correlation at extreme BQX points (|BQX_45| > 2σ)",
    "extreme_count": 5000,
    "strategy_expansion": "/mandate/CORRELATION_STRATEGY_EXPANSION.md",
    "top_performers": {
      "reg_slope_720": 0.9709,
      "mom_diff_720": 0.9702,
      "der_v1_720": 0.9702,
      "bqx_720": 0.9689,
      "mom_roc_720": 0.9689
    },
    "expected_polynomial_performers": [
      "reg_lin_term_720 (β₁ × 720 - scaled linear at endpoint)",
      "reg_quad_term_720 (β₂ × 720² - scaled quadratic at endpoint)",
      "reg_residual_720 (rate - (quad_term + lin_term + const_term))",
      "reg_forecast_5_720 (direct prediction)",
      "reg_acceleration_720 (reversal detection)",
      "reg_trend_str_720 (normalized trend)"
    ]
  },
  "recent_milestones": {
    "2025-11-29": [
      "CRITICAL: Identified polynomial regression feature gap (492 tables)",
      "Created feature specifications for reg_, cov_reg_, var_reg_, csi_reg_, tri_reg_, mkt_reg_",
      "BA Directive: Implement quadratic polynomial features (lin_term, quad_term, residual)",
      "Documented correlation strategy expansion (817 → 1,069+ features)",
      "Deployed BQ-to-Box Cloud Run service for automated disaster recovery",
      "Created Cloud Scheduler jobs for BigQuery table exports",
      "Completed feature matrix audit: PRIMARY 100%+, CORRELATION 100%, COVARIANCE 23.6%",
      "Authorized OPTION A: Full cov_* remediation (1,798 tables)",
      "Created FEATURE_TABLE_DIRECTORY.md documenting all required tables",
      "BA Directive: Complete covariance pair-combination coverage (~8 hours)"
    ],
    "2025-11-28": [
      "Completed BigQuery migration to us-central1 (2,463 tables)",
      "Phase 0: Migration and infrastructure optimization (40-95x performance gain)",
      "Phase 1: Primary features (LAG, REGIME, Correlation IDX variants)",
      "Phase 1B: BQX dual variants (lag_bqx_*, regime_bqx_*)",
      "Discovered and remediated BQX/IDX data mismatch",
      "Dual architecture: 100% complete",
      "Total tables created: 540 (31% of mandate)"
    ],
    "2024-11-24": [
      "BQX paradigm shift: BQX as both features AND targets",
      "Project inception and architecture design"
    ]
  },
  "critical_context": {
    "data_quality": {
      "idx_tables": "Real historical data (2.17M rows per pair, 6 years)",
      "bqx_tables": "Regenerated from IDX (2.17M rows per pair, matching IDX)",
      "dual_architecture": "100% complete - IDX and BQX tables mirror each other",
      "data_parity": "Achieved 2025-11-28"
    },
    "mandate_compliance": {
      "table_completion": "47.2% (1,506 of 3,192)",
      "feature_types_complete": ["PRIMARY (7 types)", "CORRELATION (1 type)"],
      "feature_types_pending": ["COVARIANCE (7 types) - 23.6% complete, remediation authorized"],
      "dual_architecture": "100% for all feature types (IDX + BQX variants)",
      "models_trained": "16 of 196 (8.2%)",
      "accuracy_target": "90%+ directional (not yet measured)",
      "remediation_status": "1,798 cov_* tables authorized for creation (~8 hours)"
    },
    "performance": {
      "migration_speedup": "40-95x faster execution in us-central1",
      "phase_1_execution": "53 minutes (vs 28-40 hour estimate)",
      "phase_1b_execution": "3 minutes (vs 10-18 minute estimate)"
    }
  }
}
