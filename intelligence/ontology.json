{
  "entities": {
    "CurrencyPair": {
      "definition": "Trading pair of two currencies (e.g., EURUSD)",
      "count": 28,
      "attributes": ["base_currency", "quote_currency", "model_id", "dataset_tables"],
      "relationships": {
        "has_model": "One-to-One with Model (PLANNED - not yet trained)",
        "generates_data": "One-to-Many with BarData",
        "produces_predictions": "One-to-Many with Prediction (PENDING model training)"
      }
    },
    "Model": {
      "definition": "Machine learning model ensemble for specific currency pair and horizon",
      "ensemble_members": ["LightGBM", "XGBoost", "CatBoost", "Meta-learner"],
      "count": 0,
      "planned_count": 784,
      "breakdown": "28 pairs × 7 horizons × 4 ensemble members",
      "horizons": ["h15", "h30", "h45", "h60", "h75", "h90", "h105"],
      "attributes": ["model_type", "pair_id", "horizon", "ensemble_role", "training_date", "performance_metrics"],
      "accuracy_target": "95%+ directional accuracy",
      "deployment_strategy": "Deploy farthest horizon achieving ≥95% per pair",
      "status": "READY - V2 migration complete, awaiting training",
      "relationships": {
        "belongs_to_pair": "Many-to-One with CurrencyPair",
        "trained_on": "Many-to-Many with Feature",
        "produces": "One-to-Many with Prediction"
      }
    },
    "Feature": {
      "definition": "Input variable for model training and prediction",
      "categories": ["lag", "regime", "correlation", "regression", "aggregation", "alignment", "momentum", "volatility"],
      "implemented_categories": ["lag", "regime", "correlation"],
      "attributes": ["feature_name", "feature_type", "calculation_method", "lag_periods"],
      "variants": ["IDX (price-based)", "BQX (momentum-based)"],
      "dual_architecture_status": "100% for implemented types",
      "relationships": {
        "used_by": "Many-to-Many with Model (PENDING)",
        "derived_from": "Many-to-One with BarData"
      }
    },
    "Target": {
      "definition": "Prediction objective (future BQX values)",
      "types": ["bqx_45", "bqx_90", "bqx_180", "bqx_360", "bqx_720", "bqx_1440", "bqx_2880"],
      "attributes": ["target_name", "horizon", "prediction_time"],
      "status": "Defined in BQX tables, not yet used for training",
      "relationships": {
        "predicted_by": "Many-to-One with Model (PENDING)",
        "validates_against": "One-to-One with ActualBQX"
      }
    },
    "BarData": {
      "definition": "OHLCV candlestick data point (1-minute intervals)",
      "source": "m1_* tables in bqx_bq_uscen1 dataset",
      "row_count_per_pair": "~2.17M (6 years of data)",
      "attributes": ["timestamp", "open", "high", "low", "close", "volume", "pair_id"],
      "relationships": {
        "belongs_to": "Many-to-One with CurrencyPair",
        "generates": "One-to-Many with Feature"
      }
    },
    "Prediction": {
      "definition": "Model output predicting future BQX values",
      "count": 0,
      "status": "NOT STARTED - pending model training",
      "attributes": ["prediction_time", "horizon", "predicted_value", "confidence", "model_id"],
      "relationships": {
        "made_by": "Many-to-One with Model (PENDING)",
        "for_pair": "Many-to-One with CurrencyPair"
      }
    },
    "Stage": {
      "definition": "Project plan stage in AirTable",
      "count": 70,
      "attributes": ["stage_id", "name", "description", "score", "status"],
      "relationships": {
        "belongs_to": "Many-to-One with Phase",
        "part_of": "Many-to-One with Plan"
      }
    },
    "Phase": {
      "definition": "Project plan phase grouping related stages",
      "count": 11,
      "completed_phases": ["Phase 0", "Phase 1", "Phase 1B"],
      "attributes": ["phase_id", "name", "description", "score"],
      "relationships": {
        "contains": "One-to-Many with Stage",
        "part_of": "Many-to-One with Plan"
      }
    }
  },
  "relationships": {
    "hierarchical": {
      "Plan": ["Phase", "Stage"],
      "CurrencyPair": ["Model (pending)", "BarData", "Prediction (pending)"],
      "Model": ["Prediction (pending)"]
    },
    "computational": {
      "BarData → IDX": "Price normalization to base=100",
      "IDX → BQX": "Momentum calculation (percentage change over lookback)",
      "IDX/BQX → Features": "Lag, regime, correlation extraction",
      "Features → Model": "Training and prediction input (PENDING)",
      "Model → Prediction": "Inference and output generation (PENDING)",
      "Prediction → Validation": "Performance measurement (PENDING)"
    }
  },
  "data_flow": {
    "ingestion": "Market Data → m1_* tables → BigQuery bqx_bq_uscen1",
    "indexing": "m1_* → {pair}_idx (price normalization)",
    "momentum": "{pair}_idx → {pair}_bqx (BQX calculation)",
    "feature_engineering": "IDX/BQX → Feature Tables (lag_*, regime_*, corr_*)",
    "training": "Features + Targets → Model Training → Trained Model (PENDING)",
    "prediction": "Latest Features → Inference → BQX Predictions (PENDING)",
    "validation": "Predictions vs Actuals → Performance Metrics (PENDING)"
  },
  "storage_hierarchy": {
    "BigQuery": {
      "location": "us-central1",
      "migration_date": "2025-12-08",
      "migration_status": "V2 COMPLETE (100%)",
      "full_catalog": "/intelligence/bigquery_v2_catalog.json",
      "partitioning": "DATE(interval_time)",
      "clustering": "pair (or pair1 for covariance tables)",
      "datasets_v2": {
        "bqx_bq_uscen1_v2": {
          "description": "Source data - partitioned, clustered",
          "tables": 2210,
          "size_gb": 131.04,
          "status": "100% COMPLETE",
          "pattern": "{pair}_m1, {pair}_idx, {pair}_bqx"
        },
        "bqx_ml_v3_features_v2": {
          "description": "Engineered features - partitioned, clustered",
          "tables": 4882,
          "size_gb": 1478.69,
          "status": "100% COMPLETE",
          "feature_types": ["covariance", "correlation", "regime", "lag", "regression", "aggregation", "alignment", "momentum", "volatility"]
        },
        "bqx_ml_v3_analytics_v2": {
          "description": "Target tables for training",
          "tables": 54,
          "size_gb": 68.34,
          "status": "ACTIVE"
        },
        "bqx_ml_v3_models": {
          "description": "Trained model artifacts",
          "tables": 16,
          "status": "READY - V2 migration complete"
        },
        "bqx_ml_v3_predictions": {
          "description": "Model prediction outputs",
          "tables": 1,
          "status": "PENDING"
        }
      },
      "datasets_v1_deleted": {
        "bqx_bq_uscen1": "DELETED 2025-12-09 (was 1,220 GB)",
        "bqx_ml_v3_features": "DELETED 2025-12-09 (was 1,279 GB)"
      },
      "storage_totals": {
        "v2_total_gb": 1678,
        "monthly_cost": "$33.56",
        "savings_realized": "$49.98/month"
      }
    },
    "Training_Platform": {
      "primary": "BigQuery ML (cost-optimized)",
      "alternative": "Vertex AI (for complex ensembles)",
      "models_planned": 784,
      "models_trained": 0,
      "structure": "28 pairs × 7 horizons × 4 ensemble members",
      "status": "READY - V2 migration complete"
    }
  }
}
