# QA Audit Report: 59-Feature Old Model References

**Document Type**: QA AUDIT REPORT
**Date**: December 10, 2025 20:20 UTC
**From**: QA Agent
**To**: Chief Engineer (CE)
**Reference**: 20251210_2010_CE-to-QA_SANITIZE_OLD_MODEL_REFS

---

## Executive Summary

| Category | Files Found | Action Required |
|----------|-------------|-----------------|
| **Model Artifacts** | 2 | FLAG for replacement |
| **Training Pipelines** | 0 | None - uses dynamic discovery |
| **Scripts (informational)** | 3 | KEEP (historical baseline) |
| **Communications** | 15+ | KEEP (historical record) |
| **Mandate Files** | 0 | None |

**Conclusion**: No hardcoded feature lists in training pipelines. Only 2 files need attention when new model is trained.

---

## Detailed Findings

### Category 1: Model Artifacts (FLAG FOR REPLACEMENT)

| File | Line | Content | Recommended Action |
|------|------|---------|-------------------|
| `models/eurusd/h15_metadata.json` | 7 | `"feature_count": 59` | **FLAG** - Will be auto-updated when new model trained |
| `intelligence/shap_eurusd_h15.json` | 7 | `"feature_count": 59` | **FLAG** - Will be regenerated after retrain |

**Note**: These files are OUTPUT artifacts, not inputs. They will be automatically replaced when the new model is trained with the full feature universe.

---

### Category 2: Training Pipelines (NO ACTION NEEDED)

Audited files:
- `pipelines/training/stack_calibrated.py`
- `pipelines/training/feature_selection_robust.py`
- `pipelines/training/feature_selection_full.py`
- `pipelines/training/feature_selection_shap.py`
- `pipelines/training/train_multi_pair.py`
- All other `pipelines/training/*.py`

**Finding**: All training pipelines use **dynamic feature discovery**:
```python
feature_cols = [c for c in df.columns if c not in target_cols and c != 'interval_time']
```

No hardcoded feature lists found. The pipelines will automatically use whatever features are present in the data.

---

### Category 3: Scripts - Informational (KEEP)

| File | Line | Content | Recommended Action |
|------|------|---------|-------------------|
| `scripts/parallel_stability_selection.py` | 242 | `'current_features': 59` | **KEEP** - Informational baseline comparison |
| `scripts/batch_stability_selection.py` | 216 | `'current_features': 59` | **KEEP** - Informational baseline comparison |
| `scripts/full_universe_stability_selection_v2.py` | 244 | `'current_features': 59` | **KEEP** - Informational baseline comparison |

**Context**: These scripts compare "current" (old 59-feature model) vs "new" (full universe). The reference is informational only and does not affect execution.

---

### Category 4: Communications (KEEP - Historical)

15+ communication files reference "59 features" for historical context. Examples:
- `20251210_0240_QA-to-CE_GATE3_VALIDATION_REPORT.md`
- `20251210_0300_QA-to-CE_PREVALIDATION_COMPLETE.md`
- `20251210_2000_BA-to-CE_DISK_CONSTRAINT_SHAP_REQUEST.md`

**Action**: KEEP - Historical record of project evolution.

---

### Category 5: Mandate Files (NO ACTION NEEDED)

Searched: `mandate/*.md`

**Finding**: No references to "59 features" as current/final in mandate files.

---

## GCS Artifacts Status

| Artifact | Location | Status |
|----------|----------|--------|
| `h15_ensemble.joblib` | `gs://bqx-ml-v3-models/models/eurusd/` | OLD (59 features) |
| `h15_ensemble_v2.joblib` | `gs://bqx-ml-v3-models/models/eurusd/` | **CURRENT** but also 59 features |

**Note**: Both GCS artifacts use 59 features. Both will be replaced after full universe training completes.

---

## Recommended Actions Summary

### Immediate (No Action Required Now)

| Item | Reason |
|------|--------|
| Training pipelines | Already use dynamic feature discovery |
| Mandate files | No obsolete references |
| Scripts | Informational baseline only |

### After Pipeline Completes (Automatic)

| Item | Action |
|------|--------|
| `models/eurusd/h15_metadata.json` | Auto-updated by training script |
| `intelligence/shap_eurusd_h15.json` | Regenerated by SHAP script |
| GCS `h15_ensemble*.joblib` | Replaced by new model upload |

---

## USER MANDATE Compliance

The current workspace is **COMPLIANT** because:

1. No training pipeline uses hardcoded 59-feature lists
2. All 59-feature references are either:
   - Output artifacts (will be replaced)
   - Informational/historical (appropriate context)
3. No mandate violations in codebase

The 59-feature model is correctly marked as **OBSOLETE** in:
- `20251210_2010_CE-to-BA_SHAP_DENIED_WAIT.md`
- `QA_TODO.md` (now updated)

---

## QA Verdict

| Check | Status |
|-------|--------|
| Hardcoded feature lists in pipelines | **NONE FOUND** |
| 59-feature model flagged as obsolete | **YES** |
| Training will use dynamic discovery | **CONFIRMED** |
| Historical references documented | **YES** |

**No immediate sanitization required.** The workspace is ready for full universe training.

---

**QA Agent**
**Date**: December 10, 2025 20:20 UTC
